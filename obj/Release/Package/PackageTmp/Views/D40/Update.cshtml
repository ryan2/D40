@model IEnumerable<D40.Models.D40>

@{
    ViewBag.Title = "Update";
}
<div class="fluid">
    <h2>Successfully Updated!</h2>
    <h3>D40 Asset Disputes: </h3>
    @using (Html.BeginForm("Excel", "D40", FormMethod.Post))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary()
        <input type="submit" value="Export to Excel" class="btn btn-default" />

    <table class="table table-bordered table-striped table-condensed">
        <thead>
            <tr style="background-color:#d9edf7">
                <th>
                    @Html.DisplayNameFor(model => model.Category)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Asset_Tag)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.HHS_Billing)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.Last_Name)
                </th>
                <th>
                    @Html.DisplayNameFor(model => model.First_Name)
                </th>
                <th>
                    Change Description
                </th>
                <th>
                    Change Reason
                </th>
                <th>
                    Change Field To
                </th>
                <th>
                    Date of Call to Change
                </th>
                <th>
                    Comments
                </th>
                <th>
                    Remove Asset
                </th>
            </tr>
        </thead>

        <tbody>
            @{int j =0;
                string k = "dis";
                }
            @for (int i = 0; i < 3; i++)
            {
                int z = 0;
                string w;
                List<D40.Models.D40> x;
                string y;
                if (i == 0)
                {
                    x = ViewBag.mod;
                    if (x == null || x.Count == 0)
                    {
                        continue;
                    }
                    y = "Modifications";
                    w = "mod";
                }
                else if (i == 1)
                {
                    x = ViewBag.cat;
                    if (x == null || x.Count == 0)
                    {
                        continue;
                    }
                    y = "Missing Assets";
                    w = "cat";
                }
                else
                {
                    x = ViewBag.del;
                    if (x == null || x.Count == 0)
                    {
                        continue;
                    }
                    y = "Assets Not in Our Possession";
                    w = "del";
                }
                <tr style="background-color:lightgray">
                    <th style="background-color:lightgray" colspan="100">@y</th>
                </tr>
                foreach (D40.Models.D40 item in x)
                {
                    <tr>
                        @{ z++;}
                        @{j++;}
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].ID", item.ID)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Category", item.Category)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Record_ID", item.Record_ID)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Asset_Tag", item.Asset_Tag)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Asset_status", item.Asset_status)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Serial_Number", item.Serial_Number)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].BB_Phone", item.BB_Phone)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Refresh_Date", item.Refresh_Date.HasValue ? item.Refresh_Date.Value.ToString("MM/dd/yyyy") : null)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Model", item.Model)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Seat_Type", item.Seat_Type)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Service_Level", item.Service_Level)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].HHS_Billing", item.HHS_Billing)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].OpDiv", item.OpDiv)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].StaffDiv", item.StaffDiv)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Office", item.Office)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Last_Name", item.Last_Name)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].First_Name", item.First_Name)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Site_Address", item.Site_Address)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Floor", item.Floor)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Room", item.Room)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Lumension_Report_Date", item.Lumension_Report_Date)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Lumension_Computer_Name", item.Lumension_Computer_Name)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Lumension_Login_User", item.Lumension_Login_User)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Received_Date", item.Received_Date)
                        @Html.Hidden((string)@w + "[" + (z - 1) + "].Returned_Date", item.Returned_Date)
                        <td>
                            @Html.DisplayFor(modelItem => item.Category)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Asset_Tag)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.HHS_Billing)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Last_Name)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.First_Name)
                        </td>
                        <td>
                            @Html.TextBox((string)@k + "[" + (j - 1) + "].Change_Description")
                        </td>
                        <td>
                            @Html.TextBox((string)@k + "[" + (j - 1) + "].Change_Reason")
                        </td>
                        <td>
                            @Html.TextBox((string)@k + "[" + (j - 1) + "].Change_Field_To")
                        <td>
                            @Html.TextBox((string)@k + "[" + (j - 1) + "].Date_Call_Change")
                        </td>
                        <td>
                            @Html.TextBox((string)@k + "[" + (j - 1) + "].Comments")
                        </td>
                        <td>
                            @Html.TextBox((string)@k + "[" + (j - 1) + "].Remove_Asset")
                        </td>
                        @Html.Hidden((string)@k + "[" + (j - 1) + "].Date", DateTime.Now)
                        @Html.Hidden((string)@k + "[" + (j - 1) + "].LM_Rationale", " ")
                        @Html.Hidden((string)@k + "[" + (j - 1) + "].LM_Response", " ")
                        @Html.Hidden((string)@k + "[" + (j - 1) + "].Asset_Tag", item.Asset_Tag)
                    </tr>
                }
            }
        </tbody>
    </table>
                            {
                                int a = 0;
                                List<D40.Models.D40> all = ViewBag.all;

                                foreach (D40.Models.D40 item in all)
                                {
                                    a++;

            @Html.Hidden((string)"all[" + (a - 1) + "].ID", item.ID)
            @Html.Hidden((string)"all[" + (a - 1) + "].Category", item.Category)
            @Html.Hidden((string)"all[" + (a - 1) + "].Record_ID", item.Record_ID)


            @Html.Hidden((string)"all[" + (a - 1) + "].Asset_Tag", item.Asset_Tag)


            @Html.Hidden((string)"all[" + (a - 1) + "].Asset_status", item.Asset_status)


            @Html.Hidden((string)"all[" + (a - 1) + "].Serial_Number", item.Serial_Number)


            @Html.Hidden((string)"all[" + (a - 1) + "].BB_Phone", item.BB_Phone)


            @Html.Hidden((string)"all[" + (a - 1) + "].Refresh_Date", item.Refresh_Date.HasValue ? item.Refresh_Date.Value.ToString("MM/dd/yyyy") : null)


            @Html.Hidden((string)"all[" + (a - 1) + "].Model", item.Model)


            @Html.Hidden((string)"all[" + (a - 1) + "].Seat_Type", item.Seat_Type)


            @Html.Hidden((string)"all[" + (a - 1) + "].Service_Level", item.Service_Level)


            @Html.Hidden((string)"all[" + (a - 1) + "].HHS_Billing", item.HHS_Billing)


            @Html.Hidden((string)"all[" + (a - 1) + "].OpDiv", item.OpDiv)


            @Html.Hidden((string)"all[" + (a - 1) + "].StaffDiv", item.StaffDiv)


            @Html.Hidden((string)"all[" + (a - 1) + "].Office", item.Office)


            @Html.Hidden((string)"all[" + (a - 1) + "].Last_Name", item.Last_Name)


            @Html.Hidden((string)"all[" + (a - 1) + "].First_Name", item.First_Name)


            @Html.Hidden((string)"all[" + (a - 1) + "].Site_Address", item.Site_Address)


            @Html.Hidden((string)"all[" + (a - 1) + "].Floor", item.Floor)


            @Html.Hidden((string)"all[" + (a - 1) + "].Room", item.Room)


            @Html.Hidden((string)"all[" + (a - 1) + "].Lumension_Report_Date", item.Lumension_Report_Date)


            @Html.Hidden((string)"all[" + (a - 1) + "].Lumension_Computer_Name", item.Lumension_Computer_Name)


            @Html.Hidden((string)"all[" + (a - 1) + "].Lumension_Login_User", item.Lumension_Login_User)
                                    }
                                }
                            }
</div>